(()=>{function e(e){const n=document.getElementById("toggleBtn");n.textContent=e?"ON":"OFF",n.className="toggle "+(e?"on":"off")}function n(e){return new Promise(n=>{chrome.runtime.sendMessage(e,n)})}document.addEventListener("DOMContentLoaded",async()=>{const s=document.getElementById("content"),t=document.getElementById("toggleBtn"),i=document.getElementById("usageDisplay"),a=await n({type:"GET_SETTINGS"});e(a.enabled);const d=await n({type:"GET_USAGE"}),c="free"===a.tier?50:"‚àû";i.textContent=`${d.scans||0}/${c} scans today`,t.addEventListener("click",async()=>{const s=await n({type:"GET_SETTINGS"});e((await n({type:"UPDATE_SETTINGS",data:{enabled:!s.enabled}})).enabled)});const[l]=await chrome.tabs.query({active:!0,currentWindow:!0});if(l?.url){try{const e=await chrome.tabs.sendMessage(l.id,{type:"GET_PAGE_SCORE"});if(e?.score)return void function(e,n,s){const t=null!==n.score?Math.round(100*n.score):"?",i={HIGH_TRUST:"#22c55e",MODERATE_TRUST:"#eab308",LOW_TRUST:"#f97316",VERY_LOW_TRUST:"#ef4444",INSUFFICIENT_DATA:"#6b7280"}[n.level]||"#6b7280",a=function(e){return{HIGH_TRUST:"Likely Authentic",MODERATE_TRUST:"Mixed Signals",LOW_TRUST:"Questionable",VERY_LOW_TRUST:"Likely Inauthentic",INSUFFICIENT_DATA:"Insufficient Data"}[e]||"Unknown"}(n.level);let d="";n.issues&&n.issues.length>0&&(d=`\n      <div class="issues">\n        <div class="issues-title">Flagged Concerns</div>\n        ${n.issues.slice(0,5).map(e=>{return`\n          <div class="issue-item">\n            <div class="issue-dot ${e.severity}"></div>\n            <div>${e.detail||(n=e.signal,n.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim())}</div>\n          </div>\n        `;var n}).join("")}\n      </div>\n    `),e.innerHTML=`\n    <div class="score-section">\n      ${s?`<div class="platform-badge">${s}</div>`:""}\n      <div class="score-ring" style="color: ${i}; border-color: ${i}30">\n        ${t}${n.score,""}\n      </div>\n      <div class="score-label" style="color: ${i}">${a}</div>\n      <div class="score-message">${n.message||""}</div>\n    </div>\n    <div class="stats">\n      <div class="stat">\n        <div class="stat-value">${n.signalCount||0}</div>\n        <div class="stat-label">Signals Analyzed</div>\n      </div>\n      <div class="stat">\n        <div class="stat-value">${Math.round(100*(n.confidence||0))}%</div>\n        <div class="stat-label">Confidence</div>\n      </div>\n    </div>\n    ${d}\n  `}(s,e.score,e.platform)}catch(e){}var o;(o=l.url).includes("amazon.com")||(o.includes("reddit.com")||!(!o.includes("google.com/maps")&&!o.includes("maps.google.com")))||(s.innerHTML='\n      <div class="empty-state">\n        <div class="empty-icon">üåê</div>\n        <div class="empty-text">\n          This page isn\'t currently supported.<br>\n          Supported: Amazon, Reddit, Google Maps\n        </div>\n      </div>\n    ')}})})();